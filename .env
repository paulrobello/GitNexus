
# ========================================
# ENGINE CONFIGURATION
# ========================================

# Default engine to use ('legacy' or 'nextgen')
ENGINE_DEFAULT=nextgen

# Enable/disable engines
ENGINE_LEGACY_ENABLED=true
ENGINE_NEXTGEN_ENABLED=true

# Allow fallback between engines if one fails
ENGINE_ALLOW_FALLBACK=true

# Enable performance monitoring
ENGINE_PERFORMANCE_MONITORING=true

# Auto engine selection based on repository size (experimental)
ENGINE_AUTO_SELECTION=false

# Time threshold before falling back to another engine (ms)
ENGINE_FALLBACK_THRESHOLD_MS=10000

# ========================================
# LEGACY ENGINE CONFIGURATION
# ========================================

# Memory limits for Legacy engine
ENGINE_LEGACY_MEMORY_LIMIT_MB=512
ENGINE_LEGACY_GC_INTERVAL_MS=30000

# Processing settings for Legacy engine
ENGINE_LEGACY_BATCH_SIZE=10
ENGINE_LEGACY_TIMEOUT_MS=30000
ENGINE_LEGACY_USE_WORKERS=true

# ========================================
# NEXT-GEN ENGINE CONFIGURATION
# ========================================

# KuzuDB settings
ENGINE_NEXTGEN_KUZU_DB_PATH=gitnexus.kuzu
ENGINE_NEXTGEN_KUZU_BUFFER_POOL_SIZE=256
ENGINE_NEXTGEN_KUZU_ENABLE_WAL=true
ENGINE_NEXTGEN_KUZU_ENABLE_COMPRESSION=true

# Parallel processing settings
ENGINE_NEXTGEN_MAX_WORKERS=4
ENGINE_NEXTGEN_BATCH_SIZE=20
ENGINE_NEXTGEN_WORKER_TIMEOUT_MS=60000
ENGINE_NEXTGEN_ENABLE_PARALLEL_PARSING=true

# ========================================
# PARSING MODE CONFIGURATION
# ========================================

# Choose parsing approach: 'parallel' for multi-threaded workers, 'single' for single-threaded
# - parallel: Uses Web Workers for faster processing (recommended for large projects)
# - single: Uses main thread processing (more stable, good for debugging)
# Note: VITE_ prefix is required for Vite to expose this to the client
VITE_PARSING_MODE=parallel

# ========================================
# GENERAL APPLICATION CONFIGURATION
# ========================================

# GitHub token for API access (increases rate limits)
GITHUB_TOKEN=your_github_token_here

# Logging level
LOG_LEVEL=info

# Enable performance metrics
LOG_ENABLE_METRICS=true
LOG_ENABLE_PERFORMANCE=true

# Memory configuration
MEMORY_MAX_MB=512
MEMORY_CLEANUP_THRESHOLD_MB=400

# ========================================
# EXAMPLES AND RECOMMENDED CONFIGURATIONS
# ========================================

# For large repositories (prefer Next-Gen engine):
# ENGINE_DEFAULT=nextgen
# ENGINE_NEXTGEN_MAX_WORKERS=8
# ENGINE_NEXTGEN_BATCH_SIZE=50
# ENGINE_NEXTGEN_KUZU_BUFFER_POOL_SIZE=512

# For stable processing (prefer Legacy engine):
# ENGINE_DEFAULT=legacy
# ENGINE_LEGACY_MEMORY_LIMIT_MB=1024
# ENGINE_LEGACY_BATCH_SIZE=5

# For development/testing (enable both with fallback):
# ENGINE_DEFAULT=nextgen
# ENGINE_ALLOW_FALLBACK=true
# ENGINE_PERFORMANCE_MONITORING=true

# For production (disable experimental features):
# ENGINE_AUTO_SELECTION=false
# ENGINE_NEXTGEN_ENABLE_PARALLEL_PARSING=false
# LOG_LEVEL=warn

# ========================================
# QUICK CONFIGURATION EXAMPLES
# ========================================

# To use single-threaded processing (for debugging or stability):
# VITE_PARSING_MODE=single

# To use parallel processing (for performance):
# VITE_PARSING_MODE=parallel

# To switch between modes, just change VITE_PARSING_MODE and restart the server